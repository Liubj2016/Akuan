<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Akuan : 面白い人間になりたい">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>read</title>
  </head>

  <body>
      <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/Liubj2016/Akuan">View on GitHub</a>
          <div class="clearfix">
                <ul id="menu" class="drop">
                    <li><a href="http://liubj2016.github.io/Akuan">Home</a></li>
                    <li><a>liubaojie2016@163.com</163></a></li>
                </ul>
            </div>

          <h1 id="project_title">Akuan</h1>
          <h2 id="project_tagline">面白い人間になりたい</h2>

            
        </header>
    </div>

    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
<!-- 以上是需要的头 -->


<div class="markdown-body">
  <h1>
<a id="user-content-资产波动率及其模型" class="anchor" href="#%E8%B5%84%E4%BA%A7%E6%B3%A2%E5%8A%A8%E7%8E%87%E5%8F%8A%E5%85%B6%E6%A8%A1%E5%9E%8B" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>资产波动率及其模型</h1>

<blockquote>
<p>资产波动率是金融中最常用的风险度量。本章的目的是理解波动率的特点，学习波动率模型，并获取波动率建模和应用资产波动率的经验。<br>
波动率在金融中有许多重要的应用。它是期权定价和资产分配中的一个关键因素。波动率在计算风险管理中的风险值（Value at Risk, VaR）时有重要作用。</p>
</blockquote>

<h2>
<a id="user-content-41波动率的特征" class="anchor" href="#41%E6%B3%A2%E5%8A%A8%E7%8E%87%E7%9A%84%E7%89%B9%E5%BE%81" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.1波动率的特征</h2>

<ol>
<li>存在<strong>波动率聚集(Volatility cluster)</strong>（即在某个特定时间段上波动率高，其他时间段上波动率较小）。</li>
<li>波动率随着时间的变化是<strong>连续</strong>的———波动率的跳跃式罕见的。</li>
<li>波动率不会散发到无穷———在一个固定的范围内变化。</li>
<li>存在<strong>杠杆效应(Leverage effect)</strong>，波动率一般对价格的大幅下降比上升更敏感。</li>
</ol>

<p>一般有三种类型的波动率度量：</p>

<ul>
<li>
<strong>波动率是日收益率的条件标准差</strong>：这是波动率的常见定义。</li>
<li>
<strong>隐含波动率</strong>：根据期权的价格用一个公式，如BS公式来推导出股票价格的波动率。</li>
<li>
<strong>实际波动率</strong>：应用一天之内的高频数据来估计得到的日波动率。</li>
</ul>

<h2>
<a id="user-content-42模型的结构" class="anchor" href="#42%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%BB%93%E6%9E%84" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.2模型的结构</h2>

<p>用rt表示某项资产在t时刻的对数收益率。波动率的基本思想是，序列{rt}是前后不相关或者低阶前后相关的，<strong>但序列不是独立的。</strong></p>

<div class="highlight highlight-source-r"><pre><span class="pl-v">da</span><span class="pl-k">=</span>read.table(<span class="pl-s"><span class="pl-pds">"</span>m-intcsp7309.txt<span class="pl-pds">"</span></span>,<span class="pl-v">header</span><span class="pl-k">=</span><span class="pl-c1">T</span>)

<span class="pl-v">intc</span><span class="pl-k">=</span>log(<span class="pl-smi">da</span><span class="pl-k">$</span><span class="pl-smi">intc</span><span class="pl-k">+</span><span class="pl-c1">1</span>)
<span class="pl-v">rtn</span><span class="pl-k">=</span>ts(<span class="pl-smi">intc</span>,<span class="pl-v">frequency</span><span class="pl-k">=</span><span class="pl-c1">12</span>,<span class="pl-v">start</span><span class="pl-k">=</span>c(<span class="pl-c1">1973</span>,<span class="pl-c1">1</span>))
plot(<span class="pl-smi">rtn</span>,<span class="pl-v">type</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>l<span class="pl-pds">'</span></span>,<span class="pl-v">xlab</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>year<span class="pl-pds">'</span></span>,<span class="pl-v">ylab</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>ln-rtn<span class="pl-pds">'</span></span>)

t.test(<span class="pl-smi">intc</span>)  <span class="pl-c"># 检验收益率是否为0</span>
Box.test(<span class="pl-smi">intc</span>,<span class="pl-v">lag</span><span class="pl-k">=</span><span class="pl-c1">12</span>,<span class="pl-v">type</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Ljung<span class="pl-pds">'</span></span>) <span class="pl-c">#混成检验接受原假设——序列不相关</span>

par(<span class="pl-v">mfcol</span><span class="pl-k">=</span>c(<span class="pl-c1">2</span>,<span class="pl-c1">1</span>))
acf(<span class="pl-smi">intc</span>,<span class="pl-v">lag</span><span class="pl-k">=</span><span class="pl-c1">24</span>) <span class="pl-c"># ACF plots</span>
acf(abs(<span class="pl-smi">intc</span>),<span class="pl-v">lag</span><span class="pl-k">=</span><span class="pl-c1">24</span>) 
Box.test(abs(<span class="pl-smi">intc</span>),<span class="pl-v">lag</span><span class="pl-k">=</span><span class="pl-c1">12</span>,<span class="pl-v">type</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Ljung<span class="pl-pds">'</span></span>)<span class="pl-c">#拒绝原假设——序列相关</span></pre></div>

<p><img src="images/ARCH1.png" alt="image"></p>

<p><img src="images/ARCH2.png" alt="image"></p>

<h2>
<a id="user-content-43模型的建立" class="anchor" href="#43%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%BB%BA%E7%AB%8B" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.3模型的建立</h2>

<p>对波动率建立方程需要如下4个步骤：
1. 通过检验序列的前后相关性来简历一个均值方程，消除线性依赖；
2. 对均值方程的残差进行ARCH效应检验；
3. 如果ARCH效应显著，制定一个波动率模型，并对均值方程和波动率方程进行联合估计；
4. 检查模型并改进。</p>

<h2>
<a id="user-content-44arch效应的检验" class="anchor" href="#44arch%E6%95%88%E5%BA%94%E7%9A%84%E6%A3%80%E9%AA%8C" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.4ARCH效应的检验</h2>

<p>所谓ARCH效应，简单说就是用均值方程的残差的平方来近似波动率，看其自相关函数是否显著，若显著不为0则可以认为其存在ARCH效应。</p>

<div class="highlight highlight-source-r"><pre><span class="pl-v">y</span><span class="pl-k">=</span><span class="pl-smi">intc</span><span class="pl-k">-</span>mean(<span class="pl-smi">intc</span>)
Box.test(<span class="pl-smi">y</span><span class="pl-k">^</span><span class="pl-c1">2</span>,<span class="pl-v">lag</span><span class="pl-k">=</span><span class="pl-c1">12</span>,<span class="pl-v">type</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Ljung<span class="pl-pds">'</span></span>)</pre></div>

<pre><code>$output
Box-Ljung test

data:  y^2
X-squared = 92.939, df = 12, p-value = 1.332e-14
</code></pre>

<p>可以看到P值非常显著，即显著不为0，则认为这个序列有ARCH效应。</p>

<h2>
<a id="user-content-45arch模型" class="anchor" href="#45arch%E6%A8%A1%E5%9E%8B" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.5ARCH模型</h2>

<p>ARCH模型的基本思想：</p>

<ol>
<li>资产收益率的扰动序列yt是前后不相关的，但不独立；</li>
<li>yt的不独立性可以用其滞后值的简单二次函数来描述。</li>
</ol>

<h3>
<a id="user-content-451arch模型的性质" class="anchor" href="#451arch%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%80%A7%E8%B4%A8" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.5.1ARCH模型的性质</h3>

<p>下面是一个ARCH(1)模型：</p>

<p><img src="images/ARCH3.png" alt="image"></p>

<p>性质：</p>

<ol>
<li>yt的无条件均值仍然是0，<img src="images/ARCH4.png" alt="image">
</li>
<li>yt的无条件方差：<img src="images/ARCH5.png" alt="image">
</li>
</ol>

<h3>
<a id="user-content-452arch模型的优点和缺点" class="anchor" href="#452arch%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%BC%98%E7%82%B9%E5%92%8C%E7%BC%BA%E7%82%B9" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.5.2ARCH模型的优点和缺点</h3>

<p><strong>优点</strong>：</p>

<ol>
<li>该模型可以产生波动率聚集；</li>
<li>模型的扰动yt有厚尾部。</li>
</ol>

<p><strong>缺点</strong>：</p>

<ol>
<li>无法产生波动率聚集；</li>
<li>对参数的限制相当强；</li>
<li>波动率的预报值会偏高。</li>
</ol>

<h3>
<a id="user-content-453intel股票月对数收益率的例子" class="anchor" href="#453intel%E8%82%A1%E7%A5%A8%E6%9C%88%E5%AF%B9%E6%95%B0%E6%94%B6%E7%9B%8A%E7%8E%87%E7%9A%84%E4%BE%8B%E5%AD%90" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.5.3Intel股票月对数收益率的例子</h3>

<p>通过yt^2的PACF定阶，先建立一个ARCH(3)模型<br>
<span title="MathGene HTML"><i>r</i><sub><sub><i>t</i></sub></sub> = μ+<i>y</i><sub><sub><i>t</i></sub></sub></span><br>
<span title="MathGene HTML"><i>y</i><sub><sub><i>t</i></sub></sub> = σ<sub><sub><i>t</i></sub></sub>ε<sub><sub><i>t</i></sub></sub></span><br>
<span title="MathGene HTML">σ<sub><sub><i>t</i></sub></sub><sup>2</sup> = ω+α<sub><sub>1</sub></sub><i>y</i><sub><sub><i>t</i>−1</sub></sub><sup>2</sup>+α<sub><sub>2</sub></sub><i>y</i><sub><sub><i>t</i>−2</sub></sub><sup>2</sup>+α<sub><sub>3</sub></sub>+<i>y</i><sub><sub><i>t</i>−3</sub></sub><sup>2</sup></span>  </p>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">fGarch</span>) <span class="pl-c"># Load package </span>
<span class="pl-v">da</span><span class="pl-k">=</span>read.table(<span class="pl-s"><span class="pl-pds">"</span>m-intcsp7309.txt<span class="pl-pds">"</span></span>,<span class="pl-v">header</span><span class="pl-k">=</span><span class="pl-c1">T</span>)

<span class="pl-v">intc</span><span class="pl-k">=</span>log(<span class="pl-smi">da</span><span class="pl-k">$</span><span class="pl-smi">intc</span><span class="pl-k">+</span><span class="pl-c1">1</span>)
<span class="pl-v">m1</span><span class="pl-k">=</span>garchFit(<span class="pl-k">~</span><span class="pl-c1">1</span><span class="pl-k">+</span>garch(<span class="pl-c1">3</span>,<span class="pl-c1">0</span>),<span class="pl-v">data</span><span class="pl-k">=</span><span class="pl-smi">intc</span>,<span class="pl-v">trace</span><span class="pl-k">=</span><span class="pl-c1">F</span>)<span class="pl-c">#fit model</span>
summary(<span class="pl-smi">m1</span>)</pre></div>

<pre><code>$output
Title:
 GARCH Modelling 

Call:
 garchFit(formula = ~1 + garch(3, 0), data = intc, trace = F) 

Mean and Variance Equation:
 data ~ 1 + garch(3, 0)
&lt;environment: 0x00000000123ff268&gt;
 [data = intc]

Conditional Distribution:
 norm 

Coefficient(s):
      mu     omega    alpha1    alpha2    alpha3  
0.012567  0.010421  0.232889  0.075069  0.051994  

Std. Errors:
 based on Hessian 

Error Analysis:
        Estimate  Std. Error  t value Pr(&gt;|t|)    
mu      0.012567    0.005515    2.279   0.0227 *  
omega   0.010421    0.001238    8.418   &lt;2e-16 ***
alpha1  0.232889    0.111541    2.088   0.0368 *  
alpha2  0.075069    0.047305    1.587   0.1125    
alpha3  0.051994    0.045139    1.152   0.2494    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</code></pre>

<p>可以看到alpha2和alpha3的系数不显著，所以重新拟合一个ARCH(1)模型：</p>

<div class="highlight highlight-source-r"><pre><span class="pl-v">m2</span><span class="pl-k">=</span>garchFit(<span class="pl-k">~</span><span class="pl-c1">1</span><span class="pl-k">+</span>garch(<span class="pl-c1">1</span>,<span class="pl-c1">0</span>),<span class="pl-v">data</span><span class="pl-k">=</span><span class="pl-smi">intc</span>,<span class="pl-v">trace</span><span class="pl-k">=</span><span class="pl-c1">F</span>)
summary(<span class="pl-smi">m2</span>)</pre></div>

<pre><code>$output
Title:
 GARCH Modelling 

Call:
 garchFit(formula = ~1 + garch(1, 0), data = intc, trace = F) 

Mean and Variance Equation:
 data ~ 1 + garch(1, 0)
&lt;environment: 0x000000001146bf78&gt;
 [data = intc]

Conditional Distribution:
 norm 

Coefficient(s):
      mu     omega    alpha1  
0.013130  0.011046  0.374976  

Std. Errors:
 based on Hessian 

Error Analysis:
        Estimate  Std. Error  t value Pr(&gt;|t|)    
mu      0.013130    0.005318    2.469  0.01355 *  
omega   0.011046    0.001196    9.238  &lt; 2e-16 ***
alpha1  0.374976    0.112620    3.330  0.00087 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</code></pre>

<p>现在模型的系数全部显著。</p>

<h2>
<a id="user-content-46garch模型" class="anchor" href="#46garch%E6%A8%A1%E5%9E%8B" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.6GARCH模型</h2>

<p>GARCH(1,1)=ARCH(oo)<br>
GACH(1,1)模型等价于无穷阶的ARCH模型，其形式如下：<br>
<span title="MathGene HTML"><i>r</i><sub><sub><i>t</i></sub></sub> = μ+<i>y</i><sub><sub><i>t</i></sub></sub></span><br>
<span title="MathGene HTML"><i>y</i><sub><sub><i>t</i></sub></sub> = σ<sub><sub><i>t</i></sub></sub>ε<sub><sub><i>t</i></sub></sub></span><br>
<span title="MathGene HTML">σ<sub><sub><i>t</i></sub></sub><sup>2</sup> = ω+α<i>y</i><sub><sub><i>t</i>−1</sub></sub><sup>2</sup>+βσ<sub><sub><i>t</i>−1</sub></sub><sup>2</sup></span>  </p>

<h3>
<a id="user-content-461实例说明" class="anchor" href="#461%E5%AE%9E%E4%BE%8B%E8%AF%B4%E6%98%8E" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.6.1实例说明</h3>

<p>ARCH模型的建模过程也适用于GARCH模型。一般GARCH(1,1)就够用了。</p>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">fGarch</span>)
<span class="pl-v">m4</span><span class="pl-k">=</span>garchFit(<span class="pl-k">~</span><span class="pl-c1">1</span><span class="pl-k">+</span>garch(<span class="pl-c1">1</span>,<span class="pl-c1">1</span>),<span class="pl-v">data</span><span class="pl-k">=</span><span class="pl-smi">intc</span>,<span class="pl-v">trace</span><span class="pl-k">=</span><span class="pl-c1">F</span>)
summary(<span class="pl-smi">m4</span>)

<span class="pl-v">v1</span><span class="pl-k">=</span>volatility(<span class="pl-smi">m4</span>)  <span class="pl-c"># Obtain volatility</span>
<span class="pl-v">resi</span><span class="pl-k">=</span>residuals(<span class="pl-smi">m4</span>,<span class="pl-v">standardize</span><span class="pl-k">=</span><span class="pl-c1">T</span>) <span class="pl-c"># Standardized residuals</span>
<span class="pl-v">vol</span><span class="pl-k">=</span>ts(<span class="pl-smi">v1</span>,<span class="pl-v">frequency</span><span class="pl-k">=</span><span class="pl-c1">12</span>,<span class="pl-v">start</span><span class="pl-k">=</span>c(<span class="pl-c1">1973</span>,<span class="pl-c1">1</span>))
<span class="pl-v">res</span><span class="pl-k">=</span>ts(<span class="pl-smi">resi</span>,<span class="pl-v">frequency</span><span class="pl-k">=</span><span class="pl-c1">12</span>,<span class="pl-v">start</span><span class="pl-k">=</span>c(<span class="pl-c1">1973</span>,<span class="pl-c1">1</span>))
par(<span class="pl-v">mfcol</span><span class="pl-k">=</span>c(<span class="pl-c1">2</span>,<span class="pl-c1">1</span>))  <span class="pl-c"># Show volatility and residuals</span>
plot(<span class="pl-smi">vol</span>,<span class="pl-v">xlab</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>year<span class="pl-pds">'</span></span>,<span class="pl-v">ylab</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>volatility<span class="pl-pds">'</span></span>,<span class="pl-v">type</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>l<span class="pl-pds">'</span></span>)
plot(<span class="pl-smi">res</span>,<span class="pl-v">xlab</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>year<span class="pl-pds">'</span></span>,<span class="pl-v">ylab</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>st. resi<span class="pl-pds">'</span></span>,<span class="pl-v">type</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>l<span class="pl-pds">'</span></span>) </pre></div>

<pre><code>$output
Coefficient(s):
        mu       omega      alpha1       beta1  
0.01126568  0.00091902  0.08643831  0.85258554  

Std. Errors:
 based on Hessian 

Error Analysis:
        Estimate  Std. Error  t value Pr(&gt;|t|)    
mu     0.0112657   0.0053931    2.089  0.03672 *  
omega  0.0009190   0.0003888    2.364  0.01808 *  
alpha1 0.0864383   0.0265439    3.256  0.00113 ** 
beta1  0.8525855   0.0394322   21.622  &lt; 2e-16 ***
</code></pre>

<p>可以看到系数都显著，下面是波动率序列和残差序列：</p>

<p><img src="images/GARCH1.png" alt="image"></p>

<div class="highlight highlight-source-r"><pre>par(<span class="pl-v">mfcol</span><span class="pl-k">=</span>c(<span class="pl-c1">2</span>,<span class="pl-c1">2</span>)) <span class="pl-c"># Obtain ACF &amp; PACF</span>
acf(<span class="pl-smi">resi</span>,<span class="pl-v">lag</span><span class="pl-k">=</span><span class="pl-c1">24</span>)
pacf(<span class="pl-smi">resi</span>,<span class="pl-v">lag</span><span class="pl-k">=</span><span class="pl-c1">24</span>)
acf(<span class="pl-smi">resi</span><span class="pl-k">^</span><span class="pl-c1">2</span>,<span class="pl-v">lag</span><span class="pl-k">=</span><span class="pl-c1">24</span>)
pacf(<span class="pl-smi">resi</span><span class="pl-k">^</span><span class="pl-c1">2</span>,<span class="pl-v">lag</span><span class="pl-k">=</span><span class="pl-c1">24</span>) 
<span class="pl-c">#绘制at和at^2的ACF和PACF</span></pre></div>

<p><img src="images/GARCH2.png" alt="image"></p>

<p>这些ACF和PACF确认了拟合模型充分刻画了对数收益率序列的条件均值和方差。</p>

<h2>
<a id="user-content-47指数garch模型" class="anchor" href="#47%E6%8C%87%E6%95%B0garch%E6%A8%A1%E5%9E%8B" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.7指数GARCH模型</h2>

<p>Nelson(1991)提出了指数GARCH模型(EGARCH)模型。具体地，为了允许在模型中体现正的和负的资产收益率的非对称效应，形式如下：</p>

<p><img src="images/GARCH3.png" alt="image"></p>

<p>能体现杠杆效应的还有TGARCH、APGARCH等。</p>

</div>

<!-- 以下是需要的尾 -->


<hr>
    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Akuan maintained by <a href="https://github.com/Liubj2016">Liubj2016</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>   

  </body>
</html>